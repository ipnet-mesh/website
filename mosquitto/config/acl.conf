# Mosquitto ACL Configuration for IPNet Mesh Network
# Access Control Lists define what users can publish/subscribe to

# Default permissions for all users
# Deny access to system topics by default
pattern read $SYS/broker/connection/%c/state
pattern read $SYS/broker/log/%c
pattern read $SYS/broker/clients/%c

# Allow users to read their own connection state
pattern read $SYS/broker/connection/%c/state

# Mesh network topics
# Allow mesh nodes to publish/subscribe to mesh coordination topics
user mesh-node
topic readwrite mesh/+/status
topic readwrite mesh/+/announce
topic readwrite mesh/+/data

# General mesh topics for authenticated users
user +
topic read mesh/public/+
topic write mesh/data/%u/+

# Admin user with full access
user admin
topic readwrite #

# Node status and telemetry
pattern readwrite mesh/node/%u/status
pattern readwrite mesh/node/%u/telemetry
pattern readwrite mesh/node/%u/location

# Public information exchange
topic read mesh/public/weather
topic read mesh/public/emergency
topic read mesh/public/announcements

# User-specific private topics
pattern readwrite user/%u/+
pattern readwrite private/%u/+

# Device control topics (for registered devices)
pattern readwrite device/%u/+/command
pattern readwrite device/%u/+/status
pattern readwrite device/%u/+/telemetry

# Emergency broadcast (read-only for most users)
topic read emergency/broadcast
topic read emergency/alert

# Location sharing (optional, user-controlled)
pattern readwrite location/%u/position
pattern read location/+/position

# Chat and messaging
topic readwrite chat/public
pattern readwrite chat/private/%u/+
pattern read chat/public

# Sensor data from mesh nodes
topic read sensors/+/temperature
topic read sensors/+/humidity
topic read sensors/+/air_quality
topic read sensors/+/radiation
